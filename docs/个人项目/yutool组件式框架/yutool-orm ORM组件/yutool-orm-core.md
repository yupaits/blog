# yutool-orm-core

## 1. 核心类

| 类名                 | 说明                                 | 核心属性及方法                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|----------------------|------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| BaseEntity.java      | 实体接口                             | • `ID getId();` 获取ID <br>• `void setId(ID id);` 设置ID <br>• `LocalDateTime getCreatedTime();` 获取创建时间 <br>• `String getCreatedBy();` 获取创建人 <br>• `LocalDateTime getLastModifiedTime();` 获取更新时间 <br>• `String getLastModifiedBy();` 获取更新人                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| BaseDto.java         | Dto基类                              | • `void checkValid(Collection<D> collection);` Dto集合校验方法，默认不允许集合为空 <br>• `void checkValid(Collection<D> collection, boolean allowEmpty);` Dto集合校验方法 <br>• `void checkValid();` Dto校验方法 <br>• `String[] uniqueFields();` 逻辑唯一字段，用于更新数据时进行校验 <br>• `String[] unionKeyFields();` 组合唯一索引，用于更新数据时进行校验 <br>• `Comparator<D> comparator();` 默认的Dto排序实现 <br>• `ID getId();` 获取ID <br>• `void setId(ID id);` 设置ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| BaseVo.java          | Vo基类                               | • `ID id;` ID <br>• `LocalDateTime createdTime;` 创建时间 <br>• `String createdBy;` 创建人ID <br>• `String createdByName;` 创建人用户名 <br>• `LocalDateTime lastModifiedTime;` 最近更新时间 <br>• `String lastModifiedBy;` 最近更新人ID <br>• `String lastModifiedByName;` 最近更新人用户名                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| BaseQuery.java       | 查询条件接口                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| IBaseService.java    | Service抽象接口                      | • `void setDefaultVoConfig();` 设置默认的Vo类型Class和VoBuilder <br>• `void setDefaultEntityBuilder();` 设置默认的EntityBuilder <br>• `void setVoClass(Class<Vo> voClass);` 设置VoClass，用于动态替换默认的VoClass类型 <br>• `void setVoClass(Class<Vo> voClass);` 设置VoClass，用于动态替换默认的VoClass类型 <br>• `void setEntityBuilder(EntityBuilder entityBuilder);` 设置EntityBuilder，用于动态替换默认的EntityBuilder <br>• `void setVoBuilder(VoBuilder voBuilder);` 设置VoBuilder，用于动态替换默认的VoBuilder                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| BaseService.java     | Service持久层接口（继承IBaseService）  | • `E getById(ID id);` 根据ID获取实体对象 <br>• `List<E> listByIds(Collection<ID> ids);` 根据ID集合获取实体列表 <br>• `List<E> listAll();` 获取所有实体列表 <br>• `boolean save(E entity);` 保存实体 <br>• `E saveAndFlush(E entity);` 保存实体并返回 <br>• `boolean batchSave(Collection<E> entities);` 批量保存实体集合 <br>• `boolean removeById(ID id);` 根据ID删除记录 <br>• `boolean logicDeleteById(ID id);` 根据ID逻辑删除记录 <br>• `boolean batchDeleteByIds(Collection<ID> ids);` 根据ID集合批量删除记录 <br>• `boolean batchLogicDeleteByIds(Collection<ID> ids);` 根据ID集合批量逻辑删除记录 <br>• `long countByIds(Collection<ID> ids);` 根据ID集合计数 <br>• `long countAll();` 统计所有记录数 <br>• `Vo getVoById(ID id);` 根据ID获取VO对象 <br>• `Vo getVoById(ID id, VoProps voProps);` 根据ID和VoProps获取VO对象 <br>• `List<Vo> listVoByIds(Collection<ID> ids);` 根据ID集合获取VO列表 <br>• `List<Vo> listVoByIds(Collection<ID> ids, VoProps voProps);` 根据ID集合和VoProps获取VO对象 <br>• `List<Vo> listAllVo();` 获取所有VO列表 <br>• `List<Vo> listAllVo(VoProps voProps);` 根据VoProps获取VO列表 <br>• `boolean saveDto(Dto dto);` 保存DTO <br>• `E saveAndFlushDto(Dto dto);` 保存DTO并返回实体对象 <br>• `Vo saveDtoAndReturn(Dto dto);` 保存DTO并返回VO对象 <br>• `Vo saveDtoAndReturn(Dto dto, VoProps voProps);` 保存DTO并根据VoProps返回VO对象 <br>• `boolean saveBatchDto(Collection<Dto> dtos);` 批量保存DTO集合 <br>• `List<Vo> saveBatchDtoAndReturn(Collection<Dto> dtos, VoProps voProps);` 批量保存DTO集合并根据VoProps返回VO列表 |
| BaseServiceImpl.java | ServiceImpl实现基类（实现BaseService） | • `Class<E> entityClass;` 实体对象类 <br>• `Class<? extends BaseVo<ID>> voClass;` Vo对象类 <br>• `VoBuilder voBuilder;` VoBuilder接口，用于将Entity转换成Vo <br>• `EntityBuilder entityBuilder;` EntityBuilder接口，用于Dto转换成Entity <br>• `OptService getOptService();` 获取OptService <br>• `void checkUnique(Dto dto);` 检查逻辑唯一字段和联合唯一索引的约束情况 <br>• `List<Dto> distinctAndSortDtos(Collection<Dto> dtos);` 根据逻辑唯一字段和联合唯一索引进行去重并对Dto集合进行排序 <br>• `E toEntity(Dto dto);` 将Dto转换成待Save的Entity <br>• `Vo fromEntity(E entity);` Entity转成Vo <br>• `Vo fromEntity(E entity, VoProps voProps);` 根据VoProps将Entity转成Vo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |

## 2. 全局配置

- 全局异常处理
   - `GlobalExceptionHandler`
- 聚合查询参数自动转换
   - `@AggregateDefault` 注解
   - `Aggregates` 聚合参数
   - `AggregateField` 聚合字段
   - `AggregateResult` 聚合结果
   - 聚合参数处理器
- 审计日志
   - `AuditLogger` 接口